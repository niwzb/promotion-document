## CAP理论
* Consistency、Availability、Partition tolerance

## 网络分区
* 分布式通常假设网络是异步的，意味着网络可能会导致任意的重复、丢失、延迟或者乱序的节点间消息传递。

## 两阶段提交（数据库2PC）
* 2PC是一个非常经典的强一致、中心化的原子提交协议。
> 中心化是指协议中有两类节点：一个是中心化协调者节点（coordinator）和N个参与者节点（participant）。
* 第一阶段：投票阶段 和第二阶段：提交/执行阶段。
* 2PC缺点
> 性能问题：无论是在第一阶段的过程中,还是在第二阶段,所有的参与者资源和协调者资源都是被锁住的,只有当所有节点准备完毕，事务 协调者 才会通知进行全局提交，
参与者 进行本地事务提交后才会释放资源。
> 单节点故障：由于协调者的重要性，一旦 协调者 发生故障。参与者 会一直阻塞下去。尤其在第二阶段，协调者 发生故障，那么所有的 参与者 还都处于
锁定事务资源的状态中，而无法继续完成事务操作。
* 2PC出现单点问题的三种情况
> 协调者正常,参与者宕机；协调者宕机,参与者正常；协调者和参与者都宕机。

## 三阶段提交（3PC）
* 三阶段提交协议（3PC）主要是为了解决两阶段提交协议的阻塞问题，2pc存在的问题是当协作者崩溃时，参与者不能做出最后的选择。
因此参与者可能在协作者恢复之前保持阻塞。三阶段提交（Three-phase commit），是二阶段提交（2PC）的改进版本。
> 和两阶段相比：1、 引入超时机制。同时在协调者和参与者中都引入超时机制。2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。
* 三阶段提交就有CanCommit、PreCommit、DoCommit三个阶段。
> 相比较2PC而言，3PC对于协调者（Coordinator）和参与者（Partcipant）都设置了超时时间，而2PC只有协调者才拥有超时机制。这解决了一个什么问题呢？
这个优化点，主要是避免了参与者在长时间无法与协调者节点通讯（协调者挂掉了）的情况下，无法释放资源的问题，因为参与者自身拥有超时机制会在超时后，
自动进行本地commit从而进行释放资源。而这种机制也侧面降低了整个事务的阻塞时间和范围。
另外，通过CanCommit、PreCommit、DoCommit三个阶段的设计，相较于2PC而言，多设置了一个缓冲阶段保证了在最后提交阶段之前各参与节点的状态是一致的。
以上就是3PC相对于2PC的一个提高（相对缓解了2PC中的前两个问题），但是3PC依然没有完全解决数据不一致的问题。

## TCC（适用于同步接口）
* try（操作一个中间状态）、confirm（确认提交）、cancel（取消操作）

## 消息中间件最终一致性（RocketMQ）
